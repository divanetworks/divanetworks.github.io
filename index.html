<!DOCTYPE html>
<html>
<head>

	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<title>DIVA Networks</title>

	<link rel="stylesheet" href="components/divagraph/jquery.divagraph.1.0.css" />
	<link rel="stylesheet" href="css/styles.css" />

	<style>
	#maingraph {margin:0;}
	</style>

</head>
<body>

<div id="maingraph"></div>

<script src="components/jquery/jquery-2.1.1.min.js"></script>
<script src="components/d3/d3.min.js"></script>
<script src="components/divagraph/jquery.divagraph.1.0.js"></script>

<script>
$(document).ready(function () {

	function drawMainGraph (graph) {

		/*
		Draws the main graph according to the specs received.
		*/

		// Create the circles group data

		var circles = [
				{
					type: 'circle',
					data: {
						id: 'circle-1', x: -45, y: -5, size: 100,
						strokeWidth:0, fill:'#a564a8'
					}
				},
				{
					type: 'circle',
					data: {
						id: 'circle-2', x: 16, y: 62, size: 13,
						strokeWidth:1, stroke:'#999', fill:'#fed125'
					}
				},
				{
					type: 'circle',
					data: {
						id: 'circle-3', x: 25, y: 21, size: 8,
						strokeWidth:1, stroke:'#999', fill:'#bae1d8'
					}
				},
				{
					type: 'circle',
					data: {
						id: 'circle-4', x: 50, y: 54, size: 5,
						strokeWidth:1, stroke: '#ccc', fill:'#d4ece7'
					}
				},
				{
					type: 'circle',
					data: {
						id: 'circle-5', x: 60, y: 41, size: 7,
						strokeWidth:1, stroke: '#999', fill:'#97d4c7'
					}
				},
				{
					type: 'circle',
					data: {
						id: 'circle-6', x: 73, y: 18, size: 6,
						strokeWidth:0, fill:'#dfe0e0'
					}
				},
				{
					type: 'circle',
					data: {
						id: 'circle-7', x: 82, y: 75, size: 8,
						strokeWidth:0, fill:'#a6aba9'
					}
				},
				{
					type: 'circle',
					data: {
						id: 'circle-8', x: 88, y: 38, size: 4,
						strokeWidth:0, fill:'#dfe0e0'
					}
				},

				// offgrid circles

				{ // hidden to the top right - connected to 7
					type: 'circle',
					data: {
						id: 'circle-9', x: 95, y: 110, size: 1
					}
				},
				{ // hidden to the right - connected to 8
					type: 'circle',
					data: {
						id: 'circle-10', x: 115, y: 80, size: 1
					}
				},
				{ // hidden to the bottom right - connected to 6
					type: 'circle',
					data: {
						id: 'circle-11', x: 100, y: -10, size: 1
					}
				},

				// smaller white circles
				{
					type: 'circle',
					data: {
						id: 'sm-circle-1', x: 38, y: 75, size: 2
					}
				},
				{
					type: 'circle',
					data: {
						id: 'sm-circle-2', x: 53, y: 86, size: 2.1
					}
				},
				{
					type: 'circle',
					data: {
						id: 'sm-circle-3', x: 57, y: 60, size: 1.75
					}
				},
				{
					type: 'circle',
					data: {
						id: 'sm-circle-4', x: 64, y: 72, size: 3
					}
				},
				{
					type: 'circle',
					data: {
						id: 'sm-circle-5', x: 83, y: 52, size: 1.75
					}
				},
				{
					type: 'circle',
					data: {
						id: 'sm-circle-6', x: 73, y: 33, size: 2
					}
				},
				{
					type: 'circle',
					data: {
						id: 'sm-circle-7', x: 47.8, y: 20, size: 2
					}
				},
				{
					type: 'circle',
					data: {
						id: 'sm-circle-8', x: 47.5, y: 28, size: 2
					}
				},
				{
					type: 'circle',
					data: {
						id: 'sm-circle-9', x: 38, y: 10, size: 2.5
					}
				}
		];

		// add the circle group

		$(graph).divaGraph('addObjectGroup', circles);

		// Create the line group data

		var lines = [

				// circle-3 to circle-1
				// setting interpolation to 'basis' as an example, but this is set as a default
				{
					type: 'curvedLine',
					data: {
						start: 'circle-3', end: 'circle-1',
						curve: {distance:10, offset:30, interpolate: 'basis'}
					}
				},
				{
					type: 'curvedLine',
					data: {
						start: 'circle-3', end: 'circle-1',
						curve: {distance:10, offset:20}
					}
				},
				{
					type: 'curvedLine',
					data: {
						start: 'circle-3', end: 'circle-1',
						curve: {distance:10, offset:15}
					}
				},
				{
					type: 'curvedLine',
					data: {
						start: 'circle-3', end: 'circle-1',
						curve: {distance:10, offset:10}
					}
				},
				{
					type: 'curvedLine',
					data: {
						start: 'circle-3', end: 'circle-1',
						curve: {distance:10, offset:5}
					}
				},

				// circle-2 to circle-1
				{
					type: 'curvedLine',
					data: {
						start: 'circle-2', end: 'circle-1',
						curve: {distance:5, offset:15}
					}
				},

				// circle-2 to circle-3
				{
					type: 'curvedLine',
					data: {
						start: 'circle-2', end: 'circle-3',
						curve: {distance:30, offset:-10}
					}
				},

				// circle 2 to circle 4
				{
					type: 'curvedLine',
					data: {
						start: 'circle-2', end: 'circle-4',
						curve: {distance:60, offset:-10}
					}
				},

				// circle 2 to circle 5
				{
					type: 'curvedLine',
					data: {
						start: 'circle-2', end: 'circle-5',
						curve: {distance:50, offset:22}
					}
				},

				// circle-2 to circle sm-circle-1
				{
					type: 'curvedLine',
					data: {
						start: 'circle-2', end: 'sm-circle-1',
						curve: {distance:65, offset:-5}
					}
				},



				// circle-3 to circle-5
				{
					type: 'curvedLine',
					data: {
						start: 'circle-3', end: 'circle-5',
						curve: {distance:60, offset:-13}
					}
				},

				// circle-3 to sm-circle-7
				{
					type: 'curvedLine',
					data: {
						start: 'circle-3', end: 'sm-circle-7',
						curve: {distance:50, offset:7}
					}
				},

				// circle-3 to sm-circle-8
				{
					type: 'curvedLine',
					data: {
						start: 'circle-3', end: 'sm-circle-8',
						curve: {distance:50, offset:-4}
					}
				},

				// circle-3 to sm-circle-9
				{
					type: 'curvedLine',
					data: {
						start: 'circle-3', end: 'sm-circle-9',
						curve: {distance:65, offset:2}
					}
				},

				// circle-4 to sm-circle-1
				{
					type: 'curvedLine',
					data: {
						start: 'circle-4', end: 'sm-circle-1',
						curve: {distance:65, offset:3}
					}
				},

				// circle-4 to sm-circle-2
				{
					type: 'curvedLine',
					data: {
						start: 'circle-4', end: 'sm-circle-2',
						curve: {distance:60, offset:-3}
					}
				},

				// circle-4 to sm-circle-3
				{
					type: 'curvedLine',
					data: {
						start: 'circle-4', end: 'sm-circle-3',
						curve: {distance:70, offset:-2}
					}
				},

				// sm-circle-3 to circle-5
				{
					type: 'curvedLine',
					data: {
						start: 'sm-circle-3', end: 'circle-5',
						curve: {distance:25, offset:-3}
					}
				},

				// circle-4 to circle-5
				{
					type: 'curvedLine',
					data: {
						start: 'circle-4', end: 'circle-5',
						curve: {distance:30, offset:-7}
					}
				},

				// circle-5 to sm-circle-8
				{
					type: 'curvedLine',
					data: {
						start: 'circle-5', end: 'sm-circle-8',
						curve: {distance:55, offset:-5}
					}
				},

				// circle-5 to sm-circle-4
				{
					type: 'curvedLine',
					data: {
						start: 'circle-5', end: 'sm-circle-4',
						curve: {distance:60, offset:-4}
					}
				},

				// circle-5 to circle-7
				{
					type: 'curvedLine',
					data: {
						start: 'circle-5', end: 'circle-7',
						curve: {distance:50, offset:-10}
					}
				},

				// circle-5 to sm-circle-6
				{
					type: 'curvedLine',
					data: {
						start: 'circle-5', end: 'sm-circle-6',
						curve: {distance:35, offset:-8}
					}
				},

				// circle-5 to circle-6
				{
					type: 'curvedLine',
					data: {
						start: 'circle-5', end: 'circle-6',
						curve: {distance:60, offset:7}
					}
				},

				// circle-5 to sm-circle-5
				{
					type: 'curvedLine',
					data: {
						start: 'circle-5', end: 'sm-circle-5',
						curve: {distance:65, offset:-12}
					}
				},

				// circle-5 to circle-8
				{
					type: 'curvedLine',
					data: {
						start: 'circle-5', end: 'circle-8',
						curve: {distance:42, offset:-11}
					}
				},

				// circle-6 to circle-11 (hidden)
				{
					type: 'curvedLine',
					data: {
						start: 'circle-6', end: 'circle-11',
						curve: {distance:40, offset:-10}
					}
				},

				// circle-7 to sm-circle-4
				{
					type: 'curvedLine',
					data: {
						start: 'circle-7', end: 'sm-circle-4',
						curve: {distance:60, offset:5}
					}
				},

				// circle-7 to circle-9 (hidden)
				{
					type: 'curvedLine',
					data: {
						start: 'circle-7', end: 'circle-9',
						curve: {distance:40, offset:9}
					}
				},

				// circle-8 to circle-10 (hidden)
				{
					type: 'curvedLine',
					data: {
						start: 'circle-8', end: 'circle-10',
						curve: {distance:40, offset:-10}
					}
				},

				// sm-circle-9 to circle-6
				{
					type: 'curvedLine',
					data: {
						start: 'sm-circle-9', end: 'circle-6',
						curve: {distance:40, offset:5}
					}
				}

			];

		/*
		Add the line group

		last param (true) means to prepend the lines to the svg so
		that the circles sit on top of the lines
		*/

		$(graph).divaGraph('addObjectGroup', lines, true);

		// Add the logo last so it stays on top

		$(graph).divaGraph('addObject', 'image', {
			src: 'image/diva-logo-500x155.png',
			x: 4,
			y: 93,
			position:'topleft',
			width: 500,
			height: 155,
			minWidth: 150,
			maxWidth: 300,
			scale: 0.375,
			id: 'logo'
		});

	} // drawMainGraph()

	/* create a divaGraph instance for the main graph */

	var mainGraph = $('#maingraph');

	$(mainGraph).divaGraph({
		debug:true,
		resizeSpeed: 1000,
		aspectRatio: 16/9,
		prefix: 'diva-',
		bgColor: '#fff',
		lines: {					// default line styles
			stroke: '#ccc',
			strokeWidth: 1
		},
		curves: {
			interpolation: 'basis'
		},
		circles: {				// default circle styles - these setting will draw the white circles with border
			stroke: '#ccc',
			strokeWidth: 1,
			fill: '#fff',
			size: 3
		},
		resize: function (elem) {
			
			/*
			Returns an aspect ratio depending on the width of the window
			
			elem: the jquery element of the graph

			NOTE: on the iphone, winAR ends up being slightly less than 1.777. The fix
			is to fix the precision to 2 places.
			*/

			var ar = 16 / 9,
				winAR = $(window).width() / $(window).height();
			
			winAR = winAR.toFixed(2);

			if (winAR >= ar) {
				return(ar);
			}

			return(4/3);
		}
	});

	/* draw the main graph */

	drawMainGraph(mainGraph);

});
</script>

</body>
</html>
